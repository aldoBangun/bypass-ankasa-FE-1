/* eslint-disable react-hooks/exhaustive-deps */
/* eslint-disable react-hooks/rules-of-hooks */
import Head from "next/head";
import React, { useEffect, useState } from "react";
import axios from "axios";
import FormResult from "../../components/organisms/formResult";
import { useRouter } from "next/router";
import { useDispatch, useSelector } from "react-redux";
import jwtDecode from "jwt-decode";

function result() {
  const router = useRouter();
  const [data, setData] = useState([]);

  useEffect(() => {
    getFlight();
  }, [router.query.origin]);

  const body = {
    origin: router.query.origin,
    destination: router.query.destination,
    departure: router.query.departure,
    class_category: router.query.class_category,
    child: router.query.child,
    adult: router.query.adult,
  };

  const getFlight = () => {
    axios
      .get(
        `https://bypass-ankasa-backend.herokuapp.com/tickets/detail?origin=${body?.origin}&destination=${body?.destination}&departure=${body?.departure}&class_category=${body?.class_category}`
      )
      .then((res) => {
        setData(res?.data?.data);
      })
      .catch((err) => {
        console.log(err);
      });
  };

  return (
    <>
      <Head>
        <title>Ankasa - Search Result</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/vector.png" />
      </Head>
      <div className={`d-flex justify-content-center`}>
        <FormResult
          data={data}
          origin={body?.origin}
          destination={body?.destination}
          class_category={body?.class_category}
          departure={body?.departure}
          child={body?.child}
          adult={body?.adult}
        />
      </div>
    </>
  );
}

export default result;
